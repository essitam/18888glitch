<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.3.1/lib/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.3.1/addons/p5.sound.min.js" integrity="sha512-wM+t5MzLiNHl2fwT5rWSXr2JMeymTtixiw2lWyVk1JK/jDM4RBSFoH4J8LjucwlDdY6Mu84Kj0gPXp7rLGaDyA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  </head>
  <body>
    <script type="text/javascript">
      let song, analyzer;

      function preload() {
        song = loadSound('01 Ephemeral U.mp3');
      }

      function setup() {
        createCanvas(710, 200);
        song.loop();

        // create a new Amplitude analyzer
        analyzer = new p5.Amplitude();

        // Patch the input to an volume analyzer
        analyzer.setInput(song);
      }
      function mouseClicked() {
        song.play();
      }
      function draw() {
        background(255);

        // Get the average (root mean square) amplitude
        let rms = analyzer.getLevel();
        fill(127);
        stroke(0);
        console.log(rms);
        // Draw an ellipse with size based on volume
        ellipse(width / 2, height / 2, 10 + rms * 200, 10 + rms * 200);
      }
    </script>

  </body>
</html>
